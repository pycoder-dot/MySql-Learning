##Write a MySQL query to find the name (first_name, last_name), job, department ID and name of the employees who works in London.
## here we will be using three tables which is employee_new, department,locations

SELECT 
	e.first_name AS First_Name , 
    e.last_name AS Last_Name , 
    e.job_id, 
    e.department_id,
    d.department_name
FROM employee_new e
JOIN
	department_new d
ON
	(e.department_id = d.department_id)
JOIN
	locations l ON
    (d.location_id = l.location_id)
WHERE 
	LOWER(l.city) = 'London';
    
    
##Write a MySQL query to find the employee id, name (last_name) along with their manager_id and name (last_name).

SELECT 
	e.employee_id 'EMP_id',
    e.last_name 'EMP_Name',
    m.employee_id 'Manager_id',
    m.last_name 'Manager_name'
FROM 
	employee_new e
JOIN
	employee_new m
ON 
	(e.manager_id = m.employee_id);
    
    
##Write a MySQL query to find the name (first_name, last_name) and hire date of the employees who was hired after 'Jones'.
SELECT 
	e.first_name,
    e.last_name,
    e.hire_date
FROM 
	employee_new e
JOIN 
	employee_new davies
ON
	(davies.last_name = 'Jones')
WHERE 
	davies.hire_date < e.hire_date;
    
    
##Write a MySQL query to get the department name and number of employees in the department.
SELECT 
	department_name AS 'Department Name',
    COUNT(*) AS 'No of Employees'
FROM 
	department_new
INNER JOIN 
	employee_new
ON 
	employee_new.department_id = department_new.department_id
GROUP BY
	department_new.department_id,department_name
ORDER BY
	department_name;
    
    
##Write a MySQL query to find the employee ID, job title, number of days between ending date and starting date for all jobs in department 90 from job history.
SELECT
	employee_id,
    job_title,
    end_date - start_date AS 'Days'
FROM 
	job_history
NATURAL JOIN 
	jobs
WHERE 
	department_id = 90;
    
    
    
##Write a MySQL query to display the department ID and name and first name of manager.
SELECT
	d.department_id,
    d.department_name,
    d.manager_id,
    e.first_name
FROM
	department_new d
INNER JOIN
	employee_new e
ON 
	(d.manager_id = e.employee_id);


##Write a MySQL query to display the department name, manager name, and city.
SELECT 
	d.department_name, 
    e.first_name AS 'Manager Name',
    l.city
FROM 
	department_new d
JOIN
	employee_new e
ON 
	(d.manager_id = e.employee_id)
JOIN
	locations l USING (location_id);
    
    
##Write a MySQL query to display the job title and average salary of employees.
SELECT 
	job_title,
    AVG(salary)
    
FROM 
	employee_new 
NATURAL JOIN
	jobs
GROUP BY
	job_title;
    
##Write a MySQL query to display job title, employee name, and the difference between salary of the employee and minimum salary for the job.
SELECT 
	job_title,
    first_name,
    salary - min_salary AS 'Salary - Min_salary'
FROM
	employee_new
NATURAL JOIN
	jobs;
    
    
##Write a MySQL query to display the job history that were done by any employee who is currently drawing more than 10000 of salary.
SELECT 
	jh.*
FROM
	job_history jh
JOIN
	employee_new e
ON
	(jh.employee_id = e.employee_id)
WHERE
	salary > 1000;
    
##Write a MySQL query to display the first name, last name, hire date, salary of the manager for all managers whose experience is more than 15 years.
SELECT 
	first_name,
    last_name,
    hire_date,
    salary,
    (DATEDIFF(now(), hire_date))/365 Experience
FROM
	department_new d
JOIN
	employee_new e
ON 
	(d.manager_id = e.employee_id)
WHERE
	(DATEDIFF(now(), hire_date))/365 > 15;
    
    
show tables;

